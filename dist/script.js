function resilienceHub(){return{darkMode:!1,showModal:!1,showDeleteModal:!1,showAlertModal:!1,showShareModal:!1,editingResource:null,resourceToDelete:null,userHasLocation:!1,resources:[],filteredResources:[],categories:["Food Access & Nutrition","Grow & Produce","Skills & Training","Barter & Trading","Emergency & Survival","Financial Resilience","Mutual Aid / Community Care","Self-Reliance Resources","Digital Tools & Apps","Healthcare & Wellness","Housing & Shelter","Transportation","Education & Childcare","Legal & Advocacy","Environmental & Sustainability"],neighborhoods:["Downtown","Near East","West Side","Auburn","Southeast","Kishwaukee","Loves Park","Machesney Park","Belvidere","Cherry Valley","Roscoe","South Beloit","Rockton","Winnebago","Byron","Durand","Pecatonica","New Milford"],alerts:{enabled:!0,message:"⚠️ Verify hours and availability before visiting. Some sites may change schedules with little notice."},meta:{lastUpdated:null,lastUpdatedDisplay:""},searchTerm:"",selectedCategories:[],selectedTags:[],selectedNeighborhood:"",sortBy:"verified",form:{id:"",name:"",category:"",description:"",address:"",hours:"",contact:"",website:"",eligibility:"",tagsInput:"",languagesInput:"",neighborhood:"",status:"active",notes:"",verification_date:(new Date).toISOString().split("T")[0]},init(){this.loadMeta(),this.loadData(),this.toggleDarkMode("true"===localStorage.getItem("darkMode")),this.filterResources()},loadMeta(){const e=localStorage.getItem("rockfordMeta");e&&(this.meta=JSON.parse(e)),this.meta.lastUpdated||(this.meta.lastUpdated=Date.now()),this.meta.lastUpdatedDisplay=new Date(this.meta.lastUpdated).toLocaleString();const t=localStorage.getItem("rockfordAlerts");t&&(this.alerts=JSON.parse(t))},saveMeta(){this.meta.lastUpdated=Date.now(),this.meta.lastUpdatedDisplay=new Date(this.meta.lastUpdated).toLocaleString(),localStorage.setItem("rockfordMeta",JSON.stringify(this.meta)),localStorage.setItem("rockfordAlerts",JSON.stringify(this.alerts))},loadData(){const e=localStorage.getItem("rockfordResources");e?this.resources=JSON.parse(e):(this.resources=[{id:"souls-harbor-pantry",name:"Soul's Harbor Food Pantry",category:"Food Access & Nutrition",description:"Church-run food pantry with evening and midday distributions on alternating Mondays.",address:"2802 11th St, Rockford, IL 61109",hours:"1st & 3rd Mon 5:30–7pm (some listings show 6:30–8pm); 2nd & 4th Mon 12–1pm",contact:"(815) 229-1922",website:"",eligibility:"Open to all; bring ID if available",tags:["food-pantry","groceries","church","free","distribution"],neighborhood:"Kishwaukee",languages:["English"],status:"active",notes:"Hours vary by Monday of the month; verify before visiting.",verification_date:"2025-10-30"},{id:"carpenters-place",name:"Carpenter's Place Food Pantry",category:"Food Access & Nutrition",description:"Emergency food assistance. Fresh produce and non-perishables.",address:"1149 Railroad Ave, Rockford, IL 61104",hours:"Mon–Fri 9am–4pm, Sat 10am–2pm",contact:"(815) 964-4105",website:"https://carpentersplace.org",eligibility:"Rockford residents; may request income verification",tags:["emergency","groceries","non-profit"],neighborhood:"Near East",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rock-river-garden",name:"Rock River Valley Community Garden",category:"Grow & Produce",description:"Community plots; learn gardening skills and grow food.",address:"201 S Main St, Rockford, IL 61101",hours:"Daily dawn–dusk",contact:"(815) 987-1555",website:"",eligibility:"Open to all",tags:["gardening","education","sustainability"],neighborhood:"Downtown",languages:["English"],status:"seasonal",notes:"",verification_date:"2025-10-29"},{id:"salvation-army-meals",name:"Salvation Army Community Meals",category:"Food Access & Nutrition",description:"Free hot meals daily for anyone in need.",address:"500 S Rockford Ave, Rockford, IL 61102",hours:"Daily 11:30am–1pm, 5–6:30pm",contact:"(815) 962-9658",website:"https://centralusa.salvationarmy.org/rockford",eligibility:"Open to all",tags:["meals","emergency","free"],neighborhood:"Downtown",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"winnebago-co-food-bank",name:"Northern Illinois Food Bank Distribution",category:"Food Access & Nutrition",description:"Large-scale food distribution events monthly.",address:"765 Research Parkway, Rockford, IL 61109",hours:"Monthly events - check website",contact:"(815) 961-7283",website:"https://solvehungertoday.org",eligibility:"Winnebago County residents",tags:["food-bank","distribution","emergency"],neighborhood:"Southeast",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-farmers-market",name:"Rockford City Market",category:"Food Access & Nutrition",description:"Local farmers market accepting SNAP/EBT with matching program.",address:"116 N Madison St, Rockford, IL 61107",hours:"Fri 3pm–8pm (Summer), Sat 9am–1pm (Winter)",contact:"(815) 963-2315",website:"https://rockfordcitymarket.com",eligibility:"Open to all",tags:["farmers-market","local","produce"],neighborhood:"Downtown",languages:["English"],status:"seasonal",notes:"",verification_date:"2025-10-29"},{id:"workforce-connection",name:"Workforce Connection Career Training",category:"Skills & Training",description:"Training in healthcare, manufacturing, and tech.",address:"303 N Main St, Rockford, IL 61101",hours:"Mon–Fri 8am–5pm",contact:"(815) 395-6600",website:"https://workforceconnection.org",eligibility:"Winnebago County residents, 18+",tags:["training","employment","education"],neighborhood:"Downtown",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rock-valley-college",name:"Rock Valley College Continuing Education",category:"Skills & Training",description:"Affordable vocational and life skills courses.",address:"3301 N Mulford Rd, Rockford, IL 61114",hours:"Mon–Fri 8am–5pm",contact:"(815) 921-7820",website:"https://www.rockvalleycollege.edu",eligibility:"Open to all",tags:["education","vocational","adult-learning"],neighborhood:"East Side",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"goodwill-job-training",name:"Goodwill Job Training Center",category:"Skills & Training",description:"Free job readiness and computer skills training.",address:"4610 E State St, Rockford, IL 61108",hours:"Mon–Sat 9am–6pm",contact:"(815) 965-3795",website:"https://goodwillni.org",eligibility:"No restrictions",tags:["job-training","computer-skills","free"],neighborhood:"Southeast",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-rescue-mission",name:"Rockford Rescue Mission Shelter",category:"Emergency & Survival",description:"Emergency shelter, meals, and crisis services.",address:"715 W State St, Rockford, IL 61102",hours:"24/7",contact:"(815) 965-5332",website:"https://rockfordrescuemission.org",eligibility:"Individuals experiencing homelessness",tags:["shelter","emergency","meals"],neighborhood:"Near East",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"red-cross-rockford",name:"American Red Cross - Rockford Chapter",category:"Emergency & Survival",description:"Disaster relief, emergency shelter, blood services.",address:"727 N Church St, Rockford, IL 61103",hours:"Mon–Fri 8:30am–4:30pm",contact:"(815) 963-8471",website:"https://redcross.org",eligibility:"Open to all",tags:["disaster-relief","emergency-shelter","blood-donation"],neighborhood:"Near East",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-emergency-shelter",name:"Emergency Cold Weather Shelter",category:"Emergency & Survival",description:"Activated during extreme cold weather warnings.",address:"Multiple locations - call for details",hours:"During extreme cold warnings",contact:"(815) 987-HELP",website:"",eligibility:"Anyone needing shelter from extreme cold",tags:["shelter","cold-weather","emergency"],neighborhood:"Citywide",languages:["English"],status:"seasonal",notes:"",verification_date:"2025-10-29"},{id:"united-way-rrv-211",name:"United Way 211 – Winnebago & Boone Counties",category:"Emergency & Survival",description:"24/7 helpline connecting residents to food, shelter, healthcare, mental health, and other local services.",address:"612 N Main St, Ste 300, Rockford, IL 61103",hours:"24/7",contact:"Dial 211 or (866) 813-1731",website:"https://www.unitedwayrrv.org/211",eligibility:"Open to all",tags:["211","hotline","referral","multilingual"],neighborhood:"Citywide",languages:["English","Spanish"],status:"active",notes:"Operated by United Way of Rock River Valley.",verification_date:"2025-10-30"},{id:"goodwill-financial",name:"Goodwill Financial Coaching",category:"Financial Resilience",description:"Free financial coaching, budgeting assistance, and credit counseling.",address:"4610 E State St, Rockford, IL 61108",hours:"Mon–Sat 9am–6pm",contact:"(815) 965-3795",website:"https://goodwillni.org",eligibility:"No restrictions",tags:["financial","coaching","free"],neighborhood:"Southeast",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-community-fcu",name:"Rockford Community Federal Credit Union",category:"Financial Resilience",description:"Low-cost banking, small loans, financial education.",address:"2929 Preston St, Rockford, IL 61101",hours:"Mon–Fri 9am–5pm, Sat 9am–12pm",contact:"(815) 962-9111",website:"https://rockfordcommunityfcu.org",eligibility:"Rockford area residents",tags:["banking","loans","financial-education"],neighborhood:"Near East",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"illinois-dhs-office",name:"Illinois Department of Human Services",category:"Financial Resilience",description:"SNAP, TANF, Medicaid, and other benefit applications.",address:"300 W State St, Rockford, IL 61101",hours:"Mon–Fri 8:30am–5pm",contact:"(815) 987-7100",website:"https://dhs.illinois.gov",eligibility:"Illinois residents meeting income guidelines",tags:["benefits","snap","medicaid"],neighborhood:"Downtown",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"mutual-aid-network",name:"Rockford Mutual Aid Network",category:"Mutual Aid / Community Care",description:"Community-led network for resource sharing and neighbor support.",address:"Various locations",hours:"24/7 hotline",contact:"(815) 555-HELP",website:"https://rockfordmutualaid.org",eligibility:"Open to all",tags:["emergency","support","community"],neighborhood:"Citywide",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-time-bank",name:"Rockford Time Bank",category:"Mutual Aid / Community Care",description:"Skill and service exchange using time as currency.",address:"Online/community locations",hours:"24/7 online",contact:"rockfordtimebank@email.com",website:"",eligibility:"Open to all",tags:["time-bank","skill-share","barter"],neighborhood:"Citywide",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"neighborhood-watch-network",name:"Rockford Neighborhood Watch",category:"Mutual Aid / Community Care",description:"Community safety and emergency preparedness groups.",address:"Various neighborhood meetings",hours:"Monthly meetings",contact:"(815) 987-5800",website:"",eligibility:"Neighborhood residents",tags:["safety","community","preparedness"],neighborhood:"Citywide",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-tool-library",name:"Rockford Tool Library",category:"Self-Reliance Resources",description:"Borrow tools for home repair, gardening, and projects.",address:"415 E State St, Rockford, IL 61104",hours:"Tue–Thu 4pm–7pm, Sat 10am–2pm",contact:"(815) 555-TOOL",website:"",eligibility:"Rockford residents with ID",tags:["tools","repair","diy"],neighborhood:"Near East",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"community-seed-library",name:"Rockford Seed Library",category:"Self-Reliance Resources",description:"Free seeds for gardening, save and return seeds.",address:"Rockford Public Library - Main Branch",hours:"Mon–Thu 9am–8pm, Fri–Sat 9am–5pm, Sun 1–5pm",contact:"(815) 965-6732",website:"https://rockfordpubliclibrary.org",eligibility:"Open to all",tags:["seeds","gardening","sustainability"],neighborhood:"Downtown",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"repair-cafe-rockford",name:"Rockford Repair Cafe",category:"Self-Reliance Resources",description:"Volunteers help repair items to reduce waste.",address:"Various locations - check schedule",hours:"Monthly events",contact:"repaircaferockford@email.com",website:"",eligibility:"Open to all",tags:["repair","sustainability","community"],neighborhood:"Citywide",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"beacon-survival-app",name:"Beacon Survival App",category:"Digital Tools & Apps",description:"Offline-first emergency toolkit with checklists, local radio frequencies, SOS signaling, quick notes, and links to essential resources—built for low-connectivity and privacy.",address:"Online/App",hours:"24/7",contact:"",website:"https://michaelsboost.com/Beacon/",eligibility:"Open to all",tags:["app","offline","emergency","toolkit","communication"],neighborhood:"Online",languages:["English"],status:"active",notes:"Local developer",verification_date:"2025-10-29"},{id:"the-deck-app",name:"The Deck",category:"Digital Tools & Apps",description:"A hub for card-based connection games including Common Ground, Family Cards, Couple Cards, Survival Cards, and more — designed to help families and communities reconnect, communicate, and build trust through fun and meaningful prompts.",address:"Online/App",hours:"24/7",contact:"",website:"https://michaelsboost.com/TheDeck/",eligibility:"Open to all",tags:["app","family","connection","mental-wellness","community"],neighborhood:"Online",languages:["English"],status:"active",notes:"Part of Michael’s digital resilience toolkit.",verification_date:"2025-10-29"},{id:"nextdoor-rockford",name:"Nextdoor Rockford",category:"Digital Tools & Apps",description:"Hyperlocal social network for neighborhood connections.",address:"Online/App",hours:"24/7",contact:"",website:"https://nextdoor.com",eligibility:"Neighborhood verification required",tags:["app","social","neighborhood"],neighborhood:"Citywide",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"citizen-app-rockford",name:"Citizen App - Rockford",category:"Digital Tools & Apps",description:"Real-time safety alerts and community updates.",address:"Online/App Store",hours:"24/7",contact:"",website:"https://citizen.com",eligibility:"Open to all",tags:["app","safety","alerts"],neighborhood:"Citywide",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"pulse-point-rockford",name:"PulsePoint Respond",category:"Digital Tools & Apps",description:"CPR and AED alerts for cardiac emergencies.",address:"Online/App Store",hours:"24/7",contact:"",website:"https://www.pulsepoint.org",eligibility:"Open to all",tags:["app","emergency","cpr","aed"],neighborhood:"Citywide",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"crusader-clinic",name:"Crusaders Community Health",category:"Healthcare & Wellness",description:"Federally qualified health center - sliding scale fees.",address:"1200 W State St, Rockford, IL 61102",hours:"Mon–Fri 8am–5pm, Sat 8am–12pm",contact:"(815) 968-0286",website:"https://crusaderhealth.org/",eligibility:"Open to all, sliding scale",tags:["healthcare","clinic","sliding-scale"],neighborhood:"Near East",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"swedish-american-hospital",name:"SwedishAmerican Hospital",category:"Healthcare & Wellness",description:"Full-service hospital with emergency care.",address:"1401 E State St, Rockford, IL 61104",hours:"24/7",contact:"(815) 968-4400",website:"https://www.swedishamerican.org",eligibility:"Open to all",tags:["hospital","emergency","healthcare"],neighborhood:"Near East",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"mental-health-association",name:"Rosecrance Ware Center",category:"Healthcare & Wellness",description:"Mental health and substance abuse services.",address:"526 W State St, Rockford, IL 61102",hours:"Mon–Fri 8am–5pm",contact:"(815) 965-4357",website:"https://rosecrance.org",eligibility:"Open to all",tags:["mental-health","counseling","substance-abuse"],neighborhood:"Near East",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-housing-authority",name:"Rockford Housing Authority",category:"Housing & Shelter",description:"Public housing and Section 8 voucher programs.",address:"223 S Winnebago St, Rockford, IL 61102",hours:"Mon–Fri 8am–4:30pm",contact:"(815) 489-8600",website:"https://rockfordha.org",eligibility:"Income-based",tags:["housing","section-8","low-income"],neighborhood:"Downtown",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"habitat-rockford",name:"Habitat for Humanity - Rockford",category:"Housing & Shelter",description:"Affordable home ownership and repair programs.",address:"1423 S Main St, Rockford, IL 61102",hours:"Mon–Fri 9am–5pm",contact:"(815) 963-2102",website:"https://habitatrockford.com",eligibility:"Income and need-based",tags:["housing","home-repair","affordable"],neighborhood:"Near East",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rta-rockford",name:"Rockford Mass Transit District",category:"Transportation",description:"Public bus transportation throughout Rockford.",address:"501 S Court St, Rockford, IL 61101",hours:"Mon–Sat 5:30am–10pm",contact:"(815) 961-9000",website:"https://rmtd.org",eligibility:"Open to all",tags:["transportation","bus","public"],neighborhood:"Downtown",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"bike-share-rockford",name:"Rockford Bike Share",category:"Transportation",description:"Public bicycle sharing program.",address:"Multiple downtown locations",hours:"24/7",contact:"",website:"https://rockfordbikeshare.org",eligibility:"Open to all",tags:["transportation","bike","sustainable"],neighborhood:"Downtown",languages:["English"],status:"seasonal",notes:"",verification_date:"2025-10-29"},{id:"rockford-public-library",name:"Rockford Public Library - Main Branch",category:"Education & Childcare",description:"Free internet, computers, workshops, and resources.",address:"215 N Wyman St, Rockford, IL 61101",hours:"Mon–Thu 9am–8pm, Fri–Sat 9am–5pm, Sun 1–5pm",contact:"(815) 965-6732",website:"https://rockfordpubliclibrary.org",eligibility:"Open to all",tags:["library","education","internet","workshops"],neighborhood:"Downtown",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"head-start-rockford",name:"Rockford Head Start Program",category:"Education & Childcare",description:"Free early childhood education for low-income families.",address:"Multiple locations",hours:"Mon–Fri 7:30am–5:30pm",contact:"(815) 987-9820",website:"",eligibility:"Income-based for children 3-5",tags:["childcare","education","preschool"],neighborhood:"Citywide",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"prairie-state-legal",name:"Prairie State Legal Services",category:"Legal & Advocacy",description:"Free civil legal services for low-income residents.",address:"200 S Wyman St, Rockford, IL 61101",hours:"Mon–Fri 8:30am–5pm",contact:"(815) 965-2902",website:"https://pslegal.org",eligibility:"Income-based",tags:["legal","advocacy","free"],neighborhood:"Downtown",languages:["English","Spanish"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-justice-center",name:"Rockford Justice Center",category:"Legal & Advocacy",description:"Self-help legal resources and forms.",address:"400 W State St, Rockford, IL 61101",hours:"Mon–Fri 8:30am–4:30pm",contact:"(815) 319-4500",website:"",eligibility:"Open to all",tags:["legal","self-help","resources"],neighborhood:"Downtown",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"keep-rockford-beautiful",name:"Keep Rockford Beautiful",category:"Environmental & Sustainability",description:"Community cleanups, recycling education, sustainability programs.",address:"425 E State St, Rockford, IL 61104",hours:"Mon–Fri 9am–5pm",contact:"(815) 987-8800",website:"https://keeprockfordbeautiful.org",eligibility:"Open to all",tags:["environment","sustainability","recycling"],neighborhood:"Near East",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-recycling-center",name:"Rockford Recycling Center",category:"Environmental & Sustainability",description:"Free recycling drop-off for residents.",address:"3333 Kishwaukee St, Rockford, IL 61109",hours:"Tue–Sat 8am–4pm",contact:"(815) 987-5577",website:"",eligibility:"Rockford residents",tags:["recycling","environment","free"],neighborhood:"Southeast",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-buy-nothing",name:"Rockford Buy Nothing Project",category:"Barter & Trading",description:"Hyperlocal gift economy - give, receive, share freely.",address:"Facebook Groups by neighborhood",hours:"24/7 online",contact:"",website:"",eligibility:"Neighborhood residents",tags:["barter","free","sharing"],neighborhood:"Citywide",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"},{id:"rockford-free-cycle",name:"Rockford Freecycle Network",category:"Barter & Trading",description:"Keep good stuff out of landfills - free item exchange.",address:"Online groups",hours:"24/7",contact:"",website:"https://freecycle.org",eligibility:"Open to all",tags:["free","reuse","sustainability"],neighborhood:"Citywide",languages:["English"],status:"active",notes:"",verification_date:"2025-10-29"}],this.saveData())},saveData(){localStorage.setItem("rockfordResources",JSON.stringify(this.resources)),this.saveMeta(),this.filterResources()},get allTags(){const e=new Set;return this.resources.forEach(t=>(t.tags||[]).forEach(t=>e.add(t))),Array.from(e).sort((e,t)=>e.localeCompare(t))},filterResources(){let e=this.resources.map(e=>({...e}));if(this.searchTerm){const t=this.searchTerm.toLowerCase();e=e.filter(e=>(e.name||"").toLowerCase().includes(t)||(e.description||"").toLowerCase().includes(t)||(e.category||"").toLowerCase().includes(t)||(e.tags||[]).some(e=>e.toLowerCase().includes(t)))}this.selectedCategories.length&&(e=e.filter(e=>this.selectedCategories.includes(e.category))),this.selectedTags.length&&(e=e.filter(e=>(e.tags||[]).some(e=>this.selectedTags.includes(e)))),this.selectedNeighborhood&&(e=e.filter(e=>(e.neighborhood||"").toLowerCase()===this.selectedNeighborhood.toLowerCase())),this.userHasLocation&&"distance"===this.sortBy&&e.forEach(e=>{e.distanceKm=this.distanceFromUser(e)}),this.filteredResources=this.sortResources(e)},sortResources(e=this.filteredResources){const t=[...e];switch(this.sortBy){case"name":return t.sort((e,t)=>e.name.localeCompare(t.name));case"category":return t.sort((e,t)=>e.category.localeCompare(t.category));case"distance":return t.sort((e,t)=>(e.distanceKm??1/0)-(t.distanceKm??1/0));default:return t.sort((e,t)=>new Date(t.verification_date)-new Date(e.verification_date))}},toggleCategory(e){const t=this.selectedCategories.indexOf(e);t>-1?this.selectedCategories.splice(t,1):this.selectedCategories.push(e),this.filterResources()},toggleTag(e){const t=this.selectedTags.indexOf(e);t>-1?this.selectedTags.splice(t,1):this.selectedTags.push(e),this.filterResources()},openModal(e=null){this.editingResource=e,this.form=e?{...e,tagsInput:(e.tags||[]).join(", "),languagesInput:(e.languages||[]).join(", ")}:{id:"",name:"",category:"",description:"",address:"",hours:"",contact:"",website:"",eligibility:"",tagsInput:"",languagesInput:"",neighborhood:"",status:"active",notes:"",verification_date:(new Date).toISOString().split("T")[0]},this.showModal=!0},closeModal(){this.showModal=!1,this.editingResource=null},editResource(e){this.openModal(e)},saveResource(){const e={...this.form};if(e.tags=(e.tagsInput||"").split(",").map(e=>e.trim()).filter(Boolean),e.languages=(e.languagesInput||"").split(",").map(e=>e.trim()).filter(Boolean),e.id=this.editingResource?this.editingResource.id:this.generateId(e.name),this.editingResource){const t=this.resources.findIndex(e=>e.id===this.editingResource.id);this.resources[t]=e}else this.resources.push(e);this.saveData(),this.closeModal()},confirmDelete(e){this.resourceToDelete=e,this.showDeleteModal=!0},deleteResource(){this.resourceToDelete&&(this.resources=this.resources.filter(e=>e.id!==this.resourceToDelete.id),this.saveData(),this.showDeleteModal=!1,this.resourceToDelete=null)},quickDuplicate(e){const t=JSON.parse(JSON.stringify(e));t.id=this.generateId(e.name+" copy"),t.name=e.name+" (Copy)",this.resources.push(t),this.saveData()},suggestNote(e){const t=prompt("Add a quick note for internal tracking:","Called to verify hours; voicemail.");t&&(e.notes=(e.notes?e.notes+"\n":"")+`[${(new Date).toLocaleString()}] ${t}`,this.saveData())},markVerified(e){e.verification_date=(new Date).toISOString().split("T")[0],this.saveData()},generateId:e=>(e||"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),mapLink:e=>`https://maps.google.com/?q=${encodeURIComponent(e.address||e.name||"Rockford, IL")}`,telLink(e){const t=(e||"").replace(/[^0-9+]/g,"");return t?`tel:${t}`:"#"},getLocation(){if(!navigator.geolocation)return alert("Geolocation not supported");navigator.geolocation.getCurrentPosition(e=>{this.meta.userLat=e.coords.latitude,this.meta.userLng=e.coords.longitude,this.userHasLocation=!0,this.saveMeta(),this.filterResources()},e=>alert("Could not get location: "+e.message),{enableHighAccuracy:!0,timeout:8e3})},parseCoordsFromAddress(e=""){const t=e.match(/\(([-0-9.]+),\s*([-0-9.]+)\)/);return t?{lat:parseFloat(t[1]),lng:parseFloat(t[2])}:null},distanceFromUser(e){if(!this.meta.userLat||!this.meta.userLng)return NaN;const t=this.parseCoordsFromAddress(e.address||"");if(!t)return NaN;const i=(t.lat-this.meta.userLat)*Math.PI/180,o=(t.lng-this.meta.userLng)*Math.PI/180,a=Math.sin(i/2)**2+Math.cos(this.meta.userLat*Math.PI/180)*Math.cos(t.lat*Math.PI/180)*Math.sin(o/2)**2;return 12742*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))},exportData(){const e=JSON.stringify(this.resources,null,2),t=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(t),o=document.createElement("a");o.href=i,o.download="rockford-resources.json",o.click(),URL.revokeObjectURL(i)},importData(e){const t=e.target.files[0];if(!t)return;const i=new FileReader;i.onload=i=>{try{const e=i.target.result;if(t.name.endsWith(".csv")){const t=e.split(/\r?\n/).filter(Boolean).map(e=>e.split(",")),i=t.shift().map(e=>e.trim().toLowerCase());t.forEach(e=>{const t={};i.forEach((i,o)=>t[i]=e[o]||"");const o={id:this.generateId(t.name||t.id||crypto.randomUUID()),name:t.name||"",category:t.category||"",description:t.description||"",address:t.address||"",hours:t.hours||"",contact:t.contact||"",website:t.website||"",eligibility:t.eligibility||"",tags:(t.tags||"").split(";").map(e=>e.trim()).filter(Boolean),languages:(t.languages||"").split(";").map(e=>e.trim()).filter(Boolean),neighborhood:t.neighborhood||"",status:t.status||"active",notes:t.notes||"",verification_date:t.verification_date||(new Date).toISOString().split("T")[0]};this.resources.push(o)})}else{const t=JSON.parse(e);if(!Array.isArray(t))throw new Error("JSON must be an array of resources");this.resources=t}this.saveData(),alert("Import successful")}catch(e){alert("Import error: "+e.message)}e.target.value=""},i.readAsText(t)},printList(){window.print()},copyURL(){const e=window.location.href;if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(e).then(()=>alert("✅ Link copied to clipboard!")).catch(e=>alert("❌ Copy failed: "+e.message));else{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-9999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy"),alert("✅ Link copied to clipboard!")}catch(e){alert("❌ Copy failed: "+e.message)}document.body.removeChild(t)}},openAlertEditor(){this.showAlertModal=!0},toggleDarkMode(e=null){this.darkMode=null!==e?e:!this.darkMode,localStorage.setItem("darkMode",this.darkMode),document.documentElement.classList.toggle("dark",this.darkMode);const t=this.darkMode?"#111827":"#f9fafb",i=document.querySelector('meta[name="theme-color"]'),o=document.querySelector('meta[name="msapplication-navbutton-color"]');i&&i.setAttribute("content",t),o&&o.setAttribute("content",t)}}}